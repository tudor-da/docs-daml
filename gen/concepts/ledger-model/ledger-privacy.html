<!-- Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Privacy &mdash; Daml SDK __VERSION__ documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
  
  <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  <script type="text/javascript" src="../../_static/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/copybutton.js"></script>
  
  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="next" title="Daml: Defining Contract Models Compactly" href="ledger-daml.html" />
  <link rel="prev" title="Integrity" href="ledger-integrity.html" /> 

  
  <link rel="icon" type="image/svg+xml"  href="../../_static/images/daml-logo-mark-light.svg">
  <link rel="alternate icon" href="../../_static/images/daml-favicon-1.ico">

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-MSWJMNX');</script>
  <!-- End Google Tag Manager -->

  
  <!-- Mopinion Pastea.se  start --><script type="text/javascript">(function(){var id="4s6vwov7ad6qyxhq8iwbyhocrsn2nm36k25";var js=document.createElement("script");js.setAttribute("type","text/javascript");js.setAttribute("src","//deploy.mopinion.com/js/pastease.js");js.async=true;document.getElementsByTagName("head")[0].appendChild(js);var t=setInterval(function(){try{new Pastease.load(id);clearInterval(t)}catch(e){}},50)})();</script><!-- Mopinion Pastea.se end -->
</head>

<body class="wy-body-for-nav">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MSWJMNX"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-nav-side-shadow"></div>
      <div class="wy-side-scroll">

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
          
          
          
          
          
          <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Daml Documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/installation.html">Installing the SDK</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/path-variables.html">Setting JAVA_HOME and PATH variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/manual-download.html">Manually installing the SDK</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.html">Building Your App</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/app-architecture.html">App Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/first-feature.html">Your First Feature</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.daml.com/cheat-sheet">Cheat Sheet</a></li>
</ul>
<p class="caption"><span class="caption-text">Writing Daml</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../daml/intro/0_Intro.html">An introduction to Daml</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../daml/intro/1_Token.html">1 Basic contracts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/intro/2_DamlScript.html">2 Testing templates using Daml Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/intro/3_Data.html">3 Data types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/intro/4_Transformations.html">4 Transforming data using choices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/intro/5_Restrictions.html">5 Adding constraints to a contract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/intro/6_Parties.html">6 Parties and authority</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/intro/7_Composing.html">7 Composing choices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/intro/8_Exceptions.html">8 Exception Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/intro/9_Dependencies.html">9 Working with Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/intro/10_Functional101.html">10 Functional Programming 101</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/intro/11_StdLib.html">11 Intro to the Daml Standard Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/intro/12_Testing.html">12 Testing Daml Contracts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../daml/reference/index.html">Language reference docs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../daml/reference/structure.html">Overview: template structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/reference/templates.html">Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/reference/choices.html">Choices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/reference/updates.html">Updates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/reference/data-types.html">Data types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/reference/working-with.html">Built-in functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/reference/expressions.html">Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/reference/functions.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/reference/scenarios.html">Scenarios</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/reference/file-structure.html">File structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/reference/packages.html">Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/reference/contract-keys.html">Contract keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/reference/exceptions.html">Exceptions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../daml/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../daml/patterns.html">Good design patterns</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../daml/patterns/initaccept.html">Initiate and Accept</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/patterns/multiparty-agreement.html">Multiple party agreement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/patterns/delegation.html">Delegation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/patterns/authorization.html">Authorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/patterns/locking.html">Locking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../daml/patterns/locking/locking-by-archiving.html">Locking by archiving</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/patterns/locking/locking-by-state.html">Locking by state</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../daml/patterns/locking/locking-by-safekeeping.html">Locking by safekeeping</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../daml/patterns/legends.html">Diagram legends</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Building applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../app-dev/app-arch.html">Application architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../app-dev/bindings-ts/index.html">JavaScript Client Libraries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-ts/daml2js.html">JavaScript Code Generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-ts/daml-react.html">&#64;daml/react</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-ts/daml-ledger.html">&#64;daml/ledger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-ts/daml-types.html">&#64;daml/types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-ts/testing.html">Testing Your Web App</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../json-api/index.html">HTTP JSON API Service</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../json-api/lf-value-specification.html">Daml-LF JSON Encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../json-api/search-query-language.html">Query language</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../json-api/production-setup.html">Production Setup</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../daml-script/index.html">Daml Script</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../daml-repl/index.html">Daml REPL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../upgrade/index.html">Upgrading and Extending Daml applications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../upgrade/extend.html">Extending Daml applications</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../upgrade/upgrade.html">Upgrading Daml applications</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../upgrade/automation.html">Automating the Upgrade Process</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../app-dev/authorization.html">Authorization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../app-dev/ledger-api.html">The Ledger API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/services.html">The Ledger API services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/grpc/index.html">gRPC</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/grpc/error-codes.html">Error Codes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/grpc/daml-to-ledger-api.html">How Daml types are translated to protobuf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/daml-lf-translation.html">How Daml types are translated to Daml-LF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-java/index.html">Java bindings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/bindings-java/codegen.html">Generate Java code from Daml</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/bindings-java/example.html">Ping Pong Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/bindings-java/quickstart.html">Iou Quickstart Tutorial</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-scala/index.html">Scala bindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-js.html">Node.js bindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-x-lang/index.html">Creating your own bindings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../triggers/index.html">Daml Triggers - Off-Ledger Automation in Daml</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/trigger-service/index.html">Trigger Service</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tools/trigger-service/authorization.html">Authorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tools/trigger-service/auth0_example.html">Auth0 Example Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/auth-middleware/index.html">Auth Middleware</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tools/auth-middleware/oauth2.html">OAuth 2.0 Auth Middleware</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Deploying to Daml ledgers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../deploy/index.html">Overview of Daml ledgers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deploy/generic_ledger.html">Deploying to a generic Daml ledger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deploy/ledger-topologies.html">Daml Ledger Topologies</a></li>
</ul>
<p class="caption"><span class="caption-text">Operating Daml</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ops/index.html">Daml Participant pruning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ops/connect/index.html">Operating Daml Connect</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ops/connect/helm.html">Connect Helm Chart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ops/connect/auth0.html">Setting Up Auth0</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Developer Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tools/assistant.html">Daml Assistant (<code class="docutils literal notranslate"><span class="pre">daml</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../daml/daml-studio.html">Daml Studio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/sandbox.html">Daml Sandbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/navigator/index.html">Navigator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/codegen.html">Daml codegen</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/profiler.html">Daml Profiler</a></li>
</ul>
<p class="caption"><span class="caption-text">Background concepts</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary of concepts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Daml Ledger Model</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ledger-structure.html">Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="ledger-integrity.html">Integrity</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Privacy</a></li>
<li class="toctree-l2"><a class="reference internal" href="ledger-daml.html">Daml: Defining Contract Models Compactly</a></li>
<li class="toctree-l2"><a class="reference internal" href="ledger-exceptions.html">Exceptions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../identity-and-package-management.html">Identity and Package Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../time.html">Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="../local-ledger.html">Causality and Local Ledgers</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://daml.com/examples">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Early Access Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tools/extractor.html">Extractor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/export/index.html">Ledger Export</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../daml-integration-kit/index.html">Daml Integration Kit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tools/ledger-api-test-tool/index.html">Ledger API Test Tool</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/visual.html">Visualizing Daml Contracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interoperability.html">Ledger Interoperability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/non-repudiation.html">Non-repudiation</a></li>
</ul>
<p class="caption"><span class="caption-text">Daml Ecosystem</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../support/overview.html">Daml Ecosystem Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../support/status-definitions.html">Status Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../support/component-statuses.html">Feature and Component Statuses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../support/releases.html">Releases and Versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support/compatibility.html">Portability, Compatibility, and Support Durations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support/support.html">Getting Help</a></li>
</ul>

          
          
          
          <div class="pdf-download"><a href="../../_downloads/DigitalAssetSDK.pdf" download>Download as PDF</a></div>
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <div class="topbar fixed">
        
        <nav class="wy-nav-top" aria-label="top navigation">
          
          <i data-toggle="wy-nav-top" class="wy-nav-top-toggle"></i>
          
        </nav>
        <!-- Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->

<div class="navbar">
    <h1><img src="../../_static/images/DAML_Logo_Blue.svg"></h1>
    <div class="navbar-menu">
        <div class="da-menu-item da-menu-depth-1" role="menu">
            <a href="https://www.daml.com/" role="menuitem" class="da-menu-link">Developers</a>
        </div>
        <div class="da-menu-item da-menu-depth-1" role="menu">
            <a href="https://www.digitalasset.com/products" role="menuitem" class="da-menu-link">Products</a>
        </div>
        <div class="da-menu-item da-menu-depth-1" role="menu">
            <a href="https://www.digitalasset.com" role="menuitem" class="da-menu-link">Company</a>
        </div>
    </div>
</div>

        <div class="version ">
          <span class="hide-mobile">Version&nbsp;</span><span class="version_switcher_placeholder"></span>
          
        </div>


        <!-- Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->
<div class="search-inline">
    <div id="rtd-search-inline-form" class="wy-form">
        <input type="text" class="search-inline-input" placeholder="Search" name="q">
        <img src="../../_static/images/Search.svg" class="search-inline-img"/>
    </div>
    <div class="search-alert">
        Please enter at least 3 letters.
    </div>
    <div id="search-inline-results" class="search-inline-results">
        
    </div>
</div>
          <!-- Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->

<div class="content-menu collapsed">
    <span class="content-menu-title">In This Section</span>
    <span class="content-menu-expand"></span>
    <div class="content-menu-wrapper">
        
        <!-- Local TOC -->
        <div class="content-menu-toc"><ul>
<li><a class="reference internal" href="#">Privacy</a><ul>
<li><a class="reference internal" href="#contract-observers-and-stakeholders">Contract Observers and Stakeholders</a></li>
<li><a class="reference internal" href="#choice-observers">Choice Observers</a></li>
<li><a class="reference internal" href="#projections">Projections</a></li>
<li><a class="reference internal" href="#privacy-through-authorization">Privacy through authorization</a></li>
<li><a class="reference internal" href="#divulgence-when-non-stakeholders-see-contracts">Divulgence: When Non-Stakeholders See Contracts</a></li>
</ul>
</li>
</ul>
</div>
        
    </div>
</div>
        

      </div>
      <div class="wy-nav-content">
        
        <div class="rst-content">
          
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div itemprop="articleBody">
                
  <div class="section" id="privacy">
<span id="da-model-privacy"></span><h1>Privacy<a class="headerlink" href="#privacy" title="Permalink to this headline">¶</a></h1>
<p>The previous sections have addressed two out of three questions posed in the
introduction: “what the ledger looks like”, and “who may request which changes”.
This section addresses the last one, “who sees which changes and data”. That is,
it explains the privacy model for Daml ledgers.</p>
<p>The privacy model of Daml Ledgers is based on a <strong>need-to-know
basis</strong>, and provides privacy <strong>on the level of subtransactions</strong>. Namely, a party learns only those
parts of ledger changes that affect contracts in which the party has a stake,
and the consequences of those changes.
And maintainers see all changes to the contract keys they maintain.</p>
<p>To make this more precise, a stakeholder concept is needed.</p>
<div class="section" id="contract-observers-and-stakeholders">
<h2>Contract Observers and Stakeholders<a class="headerlink" href="#contract-observers-and-stakeholders" title="Permalink to this headline">¶</a></h2>
<p>Intuitively, as signatories are bound by a contract, they have a stake in it.
Actors might not be bound by the contract, but they still have a stake in their actions, as these are the actor’s rights.
Generalizing this, <strong>observers</strong> are parties who might not be bound by the contract, but still have the right to see the contract.
For example, Alice should be an observer of the <cite>PaintOffer</cite>, such that she is made aware that the offer exists.</p>
<p>Signatories are already determined by the contract model discussed so far.
The full <strong>contract model</strong> additionally specifies the <strong>contract observers</strong> on each contract.
A <strong>stakeholder</strong> of a contract (according to a given contract model) is then either a signatory or a contract observer on the contract.
Note that in Daml, as detailed <a class="reference internal" href="ledger-daml.html#da-model-daml"><span class="std std-ref">later</span></a>, controllers specified using simple syntax are automatically made contract observers whenever possible.</p>
<p>In the graphical representation of the paint offer acceptance below, contract observers who are not signatories are indicated by an underline.</p>
<div align="center" class="align-center"><img alt="../../_images/stakeholders-paint-offer.svg" src="../../_images/stakeholders-paint-offer.svg" width="60%" /></div>
</div>
<div class="section" id="choice-observers">
<h2>Choice Observers<a class="headerlink" href="#choice-observers" title="Permalink to this headline">¶</a></h2>
<p>In addition to contract observers, the contract model can also specify <strong>choice observers</strong> on individual <strong>Exercise</strong> actions.
Choice observers get to see a specific exercise on a contract, and to view its consequences.
Choice observers are not considered stakeholders of the contract, they only affect the set of informees
on an action, for the purposes of projection (see below).</p>
</div>
<div class="section" id="projections">
<span id="da-model-projections"></span><h2>Projections<a class="headerlink" href="#projections" title="Permalink to this headline">¶</a></h2>
<p>Stakeholders should see changes to contracts they hold a stake in, but that does not
mean that they have to see the entirety of any transaction that their contract is
involved in. This is made precise through <em>projections</em> of a transaction,
which define the view that each party gets on a transaction.
Intuitively, given a transaction within a commit, a party will see
only the subtransaction consisting of all actions on contracts where the party
is a stakeholder. Thus, privacy is obtained on the subtransaction level.</p>
<p>An example is given below. The transaction that consists
only of Alice’s acceptance of the <cite>PaintOffer</cite> is projected for each of the
three parties in the example: the painter, Alice, and the bank.</p>
<div align="center" class="align-center"><img alt="../../_images/projecting-transactions-paint-offer.svg" src="../../_images/projecting-transactions-paint-offer.svg" width="60%" /></div>
<p>Since both the painter and Alice are stakeholders of the <cite>PaintOffer</cite>
contract, the exercise on this contract is kept in the projection of both
parties. Recall that consequences of an exercise action are a part of
the action. Thus, both parties also see the exercise on the <cite>Iou Bank A</cite>
contract, and the creations of the <cite>Iou Bank P</cite> and <cite>PaintAgree</cite> contracts.</p>
<p>The bank is <em>not</em> a stakeholder on the <cite>PaintOffer</cite> contract (even
though it is mentioned in the contract). Thus, the projection for the
bank is obtained by projecting the consequences of the exercise on the
<cite>PaintOffer</cite>. The bank is a stakeholder in the contract <cite>Iou Bank A</cite>,
so the exercise on this contract is kept in the bank’s projection. Lastly,
as the bank is not a stakeholder of the <cite>PaintAgree</cite> contract, the
corresponding <strong>Create</strong> action is dropped from the bank’s projection.</p>
<p>Note the privacy implications of the bank’s projection. While the bank
learns that a transfer has occurred from <cite>A</cite> to <cite>P</cite>, the bank does
<em>not</em> learn anything about <em>why</em> the transfer occurred. In
practice, this means that the bank does not learn what <cite>A</cite> is paying
for, providing privacy to <cite>A</cite> and <cite>P</cite> with respect to the bank.</p>
<p id="def-informee">As a design choice, Daml Ledgers show to contract observers only the
<a class="reference internal" href="ledger-integrity.html#def-contract-state"><span class="std std-ref">state changing</span></a> actions on the contract.
More precisely, <strong>Fetch</strong> and non-consuming <strong>Exercise</strong> actions are not shown to contract observers - except when they are
also actors or choice observers of these actions.
This motivates the following definition: a party <cite>p</cite> is an <strong>informee</strong> of an action <cite>A</cite> if one of the following holds:</p>
<blockquote>
<div><ul class="simple">
<li><cite>A</cite> is a <strong>Create</strong> on a contract <cite>c</cite> and <cite>p</cite> is a stakeholder of <cite>c</cite>.</li>
<li><cite>A</cite> is a consuming <strong>Exercise</strong> on a contract <cite>c</cite>, and <cite>p</cite> is a stakeholder of <cite>c</cite> or an actor on <cite>A</cite>.
Note that a Daml “flexible controller” <a class="reference internal" href="ledger-daml.html#da-model-daml"><span class="std std-ref">can be an exercise actor without being a contract stakeholder</span></a>.</li>
<li><cite>A</cite> is a non-consuming <strong>Exercise</strong> on a contract <cite>c</cite>, and <cite>p</cite> is a signatory of <cite>c</cite> or an actor on <cite>A</cite>.</li>
<li><cite>A</cite> is an <strong>Exercise</strong> action and <cite>p</cite> is a choice observer on <cite>A</cite>.</li>
<li><cite>A</cite> is a <strong>Fetch</strong> on a contract <cite>c</cite>, and <cite>p</cite> is a signatory of <cite>c</cite> or an actor on <cite>A</cite>.</li>
<li><cite>A</cite> is a <strong>NoSuchKey</strong> <cite>k</cite> assertion and <cite>p</cite> is a maintainer of <cite>k</cite>.</li>
</ul>
</div></blockquote>
<p id="def-tx-projection">Then, we can formally define the <strong>projection</strong> of a
transaction <cite>tx = act</cite><sub>1</sub><cite>, …, act</cite><sub>n</sub> for a party <cite>p</cite> is the
subtransaction obtained by doing the following for each action <cite>act</cite><sub>i</sub>:</p>
<ol class="arabic simple">
<li>If <cite>p</cite> is an informee of <cite>act</cite><sub>i</sub>, keep <cite>act</cite><sub>i</sub> as-is.</li>
<li>Else, if <cite>act</cite><sub>i</sub> has consequences, replace <cite>act</cite><sub>i</sub> by the projection (for <cite>p</cite>) of its consequences,
which might be empty.</li>
<li>Else, drop <cite>act</cite><sub>i</sub>.</li>
</ol>
<p id="da-model-ledger-projection">Finally, the <strong>projection of a ledger</strong> <cite>l</cite> for a party <cite>p</cite> is a list
of transactions obtained by first projecting the transaction of each
commit in <cite>l</cite> for <cite>p</cite>, and then removing all empty transactions from
the result. Note that the projection of a ledger is not a ledger, but
a list of transactions. Projecting the ledger of our
complete paint offer example yields the following projections for each
party:</p>
<div align="center" class="align-center"><img alt="../../_images/projecting-ledgers-paint-offer.svg" id="da-ledgers-projections-example" src="../../_images/projecting-ledgers-paint-offer.svg" width="100%" /></div>
<p>Examine each party’s projection in turn:</p>
<ol class="arabic simple">
<li>The painter does not see any part of the first commit, as he is
not a stakeholder of the <cite>Iou Bank A</cite> contract. Thus, this
transaction is not present in the projection for the painter at
all. However, the painter is a stakeholder in the <cite>PaintOffer</cite>,
so he sees both the creation and the exercise of this contract
(again, recall that all consequences of an exercise action are a
part of the action itself).</li>
<li>Alice is a stakeholder in both the <cite>Iou Bank A</cite> and
<cite>PaintOffer A B Bank</cite> contracts. As all top-level actions in the ledger are
performed on one of these two contracts, Alice’s projection
includes all the transactions from the ledger intact.</li>
<li>The Bank is only a stakeholder of the IOU contracts.
Thus, the bank sees the first commit’s
transaction as-is. The second commit’s transaction is, however
dropped from the bank’s projection. The projection of the last
commit’s transaction is as described above.</li>
</ol>
<p>Ledger projections do not always satisfy the definition of
consistency, even if the ledger does. For example, in P’s view, <cite>Iou Bank A</cite> is
exercised without ever being created, and thus without being made
active. Furthermore, projections can in general be
non-conformant. However, the projection for a party <cite>p</cite> is always</p>
<ul class="simple">
<li>internally consistent for all contracts,</li>
<li>consistent for all contracts on which <cite>p</cite> is a stakeholder, and</li>
<li>consistent for the keys that <cite>p</cite> is a maintainer of.</li>
</ul>
<p>In other words,
<cite>p</cite> is never a stakeholder on any input contracts of its projection. Furthermore, if the
contract model is <strong>subaction-closed</strong>, which
means that for every action <cite>act</cite> in the model, all subactions of
<cite>act</cite> are also in the model, then the projection is guaranteed to be
conformant. As we will see shortly, Daml-based contract models are
conformant. Lastly, as projections carry no information about the
requesters, we cannot talk about authorization on the level of
projections.</p>
</div>
<div class="section" id="privacy-through-authorization">
<span id="da-model-privacy-authorization"></span><h2>Privacy through authorization<a class="headerlink" href="#privacy-through-authorization" title="Permalink to this headline">¶</a></h2>
<p>Setting the maintainers as required authorizers for a <strong>NoSuchKey</strong> assertion ensures
that parties cannot learn about the existence of a contract without having a right to know about their existence.
So we use authorization to impose <em>access controls</em> that ensure confidentiality about the existence of contracts.
For example, suppose now that for a <cite>PaintAgreement</cite> contract, both signatories are key maintainers, not only the painter.
That is, we consider <cite>PaintAgreement &#64;A &#64;P &amp;P123</cite> instead of <cite>PaintAgreement $A &#64;P &amp;P123</cite>.
Then, when the painter’s competitor <cite>Q</cite> passes by <cite>A</cite>’s house and sees that the house desperately needs painting,
<cite>Q</cite> would like to know whether there is any point in spending marketing efforts and making a paint offer to <cite>A</cite>.
Without key authorization, <cite>Q</cite> could test whether a ledger implementation accepts the action <strong>NoSuchKey</strong> <cite>(A, P, refNo)</cite> for different guesses of the reference number <cite>refNo</cite>.
In particular, if the ledger does not accept the transaction for some <cite>refNo</cite>, then <cite>Q</cite> knows that <cite>P</cite> has some business with <cite>A</cite> and his chances of <cite>A</cite> accepting his offer are lower.
Key authorization prevents this flow of information because the ledger always rejects <cite>Q</cite>’s action for violating the authorization rules.</p>
<p>For these access controls, it suffices if one maintainer authorizes a <strong>NoSuchKey</strong> assertion.
However, we demand that <em>all</em> maintainers must authorize it.
This is to prevent spam in the projection of the maintainers.
If only one maintainer sufficed to authorize a key assertion,
then a valid ledger could contain <strong>NoSuchKey</strong> <cite>k</cite> assertions where the maintainers of <cite>k</cite> include, apart from the requester, arbitrary other parties.
Unlike <strong>Create</strong> actions to contract observers, such assertions are of no value to the other parties.
Since processing such assertions may be expensive, they can be considered spam.
Requiring all maintainers to authorize a <strong>NoSuchKey</strong> assertion avoids the problem.</p>
</div>
<div class="section" id="divulgence-when-non-stakeholders-see-contracts">
<span id="da-model-divulgence"></span><h2>Divulgence: When Non-Stakeholders See Contracts<a class="headerlink" href="#divulgence-when-non-stakeholders-see-contracts" title="Permalink to this headline">¶</a></h2>
<p>The guiding principle for the privacy model of Daml ledgers is that
contracts should only be shown to their stakeholders. However,
ledger projections can cause contracts to become visible to other
parties as well.</p>
<p>In the example of
<a class="reference external" href="#da-ledgers-projections-example">ledger projections of the paint offer</a>,
the exercise on the <cite>PaintOffer</cite>
is visible to both the painter and Alice.  As a consequence, the
exercise on the <cite>Iou Bank A</cite> is visible to the painter, and the
creation of <cite>Iou Bank P</cite> is visible to Alice. As actions also contain
the contracts they act on, <cite>Iou Bank A</cite> was thus shown to the painter
and <cite>Iou Bank P</cite> was shown to Alice.</p>
<p>Showing contracts to non-stakeholders through ledger projections is
called <strong>divulgence</strong>. Divulgence is a deliberate choice in the design
of Daml ledgers. In the paint offer example, the only proper way to
accept the offer is to transfer the money from Alice to the painter.
Conceptually, at the instant where the offer is accepted, its
stakeholders also gain a temporary stake in the actions on the two
<cite>Iou</cite> contracts, even though they are never recorded as stakeholders
in the contract model. Thus, they are allowed to see these actions through
the projections.</p>
<p>More precisely, every action <cite>act</cite> on <cite>c</cite> is shown to all informees of all ancestor actions
of <cite>act</cite>.
These informees are called the <strong>witnesses</strong> of <cite>act</cite>.
If one of the witnesses <cite>W</cite> is not a stakeholder on <cite>c</cite>, then <cite>act</cite> and <cite>c</cite> are said to be <strong>divulged</strong> to <cite>W</cite>.
Note that only <strong>Exercise</strong> actions can be ancestors of other actions.</p>
<p>Divulgence can be used to enable delegation. For example, consider the
scenario where Alice makes a counteroffer to the painter. Painter’s
acceptance entails transferring the IOU to him. To be able to construct the acceptance
transaction, the painter first needs to learn about the details of
the IOU that will be transferred to him. To give him these details, Alice
can fetch the IOU in a context visible to
the painter:</p>
<div align="center" class="align-center"><img alt="../../_images/divulgence-for-disclosure-counteroffer.svg" id="da-paint-counteroffer-example" src="../../_images/divulgence-for-disclosure-counteroffer.svg" width="100%" /></div>
<p>In the example, the context is provided by consuming a <cite>ShowIou</cite> contract on which the painter is a stakeholder.
This now requires an additional contract type, compared to the original paint offer example.
An alternative approach to enable this workflow, without increasing the number of contracts required, is to
replace the original <cite>Iou</cite> contract by one on which the painter is a contract observer.
This would require extending the contract model with a (consuming) exercise action on the <cite>Iou</cite> that creates a new
<cite>Iou</cite>, with observers of Alice’s choice.
In addition to the different number of commits, the two approaches differ in one more aspect.
Unlike stakeholders, parties who see contracts only through divulgence
have no guarantees about the state of the contracts in question. For
example, consider what happens if we extend our (original) paint offer example
such that the painter immediately settles the IOU.</p>
<div align="center" class="align-center"><img alt="../../_images/divulgence-stale-contracts.svg" src="../../_images/divulgence-stale-contracts.svg" width="100%" /></div>
<p>While Alice sees the creation of the <cite>Iou Bank P</cite> contract, she does
not see the settlement action. Thus, she does not know whether the
contract is still active at any point after its creation. Similarly,
in the previous example with the counteroffer, Alice could spend the
IOU that she showed to the painter by the time the painter attempts to
accept her counteroffer. In this case, the painter’s transaction could
not be added to the ledger, as it would result in a double spend and
violate validity. But the painter has no way to predict whether
his acceptance can be added to the ledger or not.</p>
</div>
</div>


              
            </div>
            
            
              <!-- Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->

<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ledger-integrity.html" class="da-btn da-btn-label btn-prev" title="Integrity" accesskey="p" rel="prev">Previous</a>
      
      
        <a href="ledger-daml.html" class="da-btn da-btn-label btn-next" title="Daml: Defining Contract Models Compactly" accesskey="n" rel="next">Next</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. Any unauthorized use, duplication or distribution is strictly prohibited. &#34;Digital Asset&#34; and &#34;Daml&#34; are Registered in the U.S. Patent and Trademark Office.

    </p>
  </div> 

</footer>
            
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->





  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.Navigation.enable(true);
      });
  </script>


  
    
  
  <div id="inpageContent"></div>
  

</body>
</html>