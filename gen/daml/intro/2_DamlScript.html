<!-- Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2 Testing templates using Daml Script &mdash; Daml SDK __VERSION__ documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
  
  <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  <script type="text/javascript" src="../../_static/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/copybutton.js"></script>
  
  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="next" title="3 Data types" href="3_Data.html" />
  <link rel="prev" title="1 Basic contracts" href="1_Token.html" /> 

  
  <link rel="icon" type="image/svg+xml"  href="../../_static/images/daml-logo-mark-light.svg">
  <link rel="alternate icon" href="../../_static/images/daml-favicon-1.ico">

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-MSWJMNX');</script>
  <!-- End Google Tag Manager -->

  
  <!-- Mopinion Pastea.se  start --><script type="text/javascript">(function(){var id="4s6vwov7ad6qyxhq8iwbyhocrsn2nm36k25";var js=document.createElement("script");js.setAttribute("type","text/javascript");js.setAttribute("src","//deploy.mopinion.com/js/pastease.js");js.async=true;document.getElementsByTagName("head")[0].appendChild(js);var t=setInterval(function(){try{new Pastease.load(id);clearInterval(t)}catch(e){}},50)})();</script><!-- Mopinion Pastea.se end -->
</head>

<body class="wy-body-for-nav">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MSWJMNX"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-nav-side-shadow"></div>
      <div class="wy-side-scroll">

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
          
          
          
          
          
          <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Daml Documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/installation.html">Installing the SDK</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/path-variables.html">Setting JAVA_HOME and PATH variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/manual-download.html">Manually installing the SDK</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.html">Building Your App</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/app-architecture.html">App Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/first-feature.html">Your First Feature</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.daml.com/cheat-sheet">Cheat Sheet</a></li>
</ul>
<p class="caption"><span class="caption-text">Writing Daml</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="0_Intro.html">An introduction to Daml</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1_Token.html">1 Basic contracts</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2 Testing templates using Daml Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_Data.html">3 Data types</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_Transformations.html">4 Transforming data using choices</a></li>
<li class="toctree-l2"><a class="reference internal" href="5_Restrictions.html">5 Adding constraints to a contract</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_Parties.html">6 Parties and authority</a></li>
<li class="toctree-l2"><a class="reference internal" href="7_Composing.html">7 Composing choices</a></li>
<li class="toctree-l2"><a class="reference internal" href="8_Exceptions.html">8 Exception Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="9_Dependencies.html">9 Working with Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_Functional101.html">10 Functional Programming 101</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_StdLib.html">11 Intro to the Daml Standard Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_Testing.html">12 Testing Daml Contracts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Language reference docs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/structure.html">Overview: template structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/templates.html">Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/choices.html">Choices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/updates.html">Updates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/data-types.html">Data types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/working-with.html">Built-in functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/expressions.html">Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/functions.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/scenarios.html">Scenarios</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/file-structure.html">File structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/packages.html">Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/contract-keys.html">Contract keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/exceptions.html">Exceptions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../patterns.html">Good design patterns</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../patterns/initaccept.html">Initiate and Accept</a></li>
<li class="toctree-l2"><a class="reference internal" href="../patterns/multiparty-agreement.html">Multiple party agreement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../patterns/delegation.html">Delegation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../patterns/authorization.html">Authorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../patterns/locking.html">Locking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../patterns/locking/locking-by-archiving.html">Locking by archiving</a></li>
<li class="toctree-l3"><a class="reference internal" href="../patterns/locking/locking-by-state.html">Locking by state</a></li>
<li class="toctree-l3"><a class="reference internal" href="../patterns/locking/locking-by-safekeeping.html">Locking by safekeeping</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../patterns/legends.html">Diagram legends</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Building applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../app-dev/app-arch.html">Application architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../app-dev/bindings-ts/index.html">JavaScript Client Libraries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-ts/daml2js.html">JavaScript Code Generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-ts/daml-react.html">&#64;daml/react</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-ts/daml-ledger.html">&#64;daml/ledger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-ts/daml-types.html">&#64;daml/types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-ts/testing.html">Testing Your Web App</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../json-api/index.html">HTTP JSON API Service</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../json-api/lf-value-specification.html">Daml-LF JSON Encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../json-api/search-query-language.html">Query language</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../json-api/production-setup.html">Production Setup</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../daml-script/index.html">Daml Script</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../daml-repl/index.html">Daml REPL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../upgrade/index.html">Upgrading and Extending Daml applications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../upgrade/extend.html">Extending Daml applications</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../upgrade/upgrade.html">Upgrading Daml applications</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../upgrade/automation.html">Automating the Upgrade Process</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../app-dev/authorization.html">Authorization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../app-dev/ledger-api.html">The Ledger API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/services.html">The Ledger API services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/grpc/index.html">gRPC</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/grpc/error-codes.html">Error Codes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/grpc/daml-to-ledger-api.html">How Daml types are translated to protobuf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/daml-lf-translation.html">How Daml types are translated to Daml-LF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-java/index.html">Java bindings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/bindings-java/codegen.html">Generate Java code from Daml</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/bindings-java/example.html">Ping Pong Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/bindings-java/quickstart.html">Iou Quickstart Tutorial</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-scala/index.html">Scala bindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-js.html">Node.js bindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-x-lang/index.html">Creating your own bindings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../triggers/index.html">Daml Triggers - Off-Ledger Automation in Daml</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/trigger-service/index.html">Trigger Service</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tools/trigger-service/authorization.html">Authorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tools/trigger-service/auth0_example.html">Auth0 Example Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/auth-middleware/index.html">Auth Middleware</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tools/auth-middleware/oauth2.html">OAuth 2.0 Auth Middleware</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Deploying to Daml ledgers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../deploy/index.html">Overview of Daml ledgers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deploy/generic_ledger.html">Deploying to a generic Daml ledger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deploy/ledger-topologies.html">Daml Ledger Topologies</a></li>
</ul>
<p class="caption"><span class="caption-text">Operating Daml</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ops/index.html">Daml Participant pruning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ops/connect/index.html">Operating Daml Connect</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ops/connect/helm.html">Connect Helm Chart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ops/connect/auth0.html">Setting Up Auth0</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Developer Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tools/assistant.html">Daml Assistant (<code class="docutils literal notranslate"><span class="pre">daml</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../daml-studio.html">Daml Studio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/sandbox.html">Daml Sandbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/navigator/index.html">Navigator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/codegen.html">Daml codegen</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/profiler.html">Daml Profiler</a></li>
</ul>
<p class="caption"><span class="caption-text">Background concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/glossary.html">Glossary of concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/ledger-model/index.html">Daml Ledger Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ledger-model/ledger-structure.html">Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ledger-model/ledger-integrity.html">Integrity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ledger-model/ledger-privacy.html">Privacy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ledger-model/ledger-daml.html">Daml: Defining Contract Models Compactly</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ledger-model/ledger-exceptions.html">Exceptions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/identity-and-package-management.html">Identity and Package Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/time.html">Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/local-ledger.html">Causality and Local Ledgers</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://daml.com/examples">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Early Access Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tools/extractor.html">Extractor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/export/index.html">Ledger Export</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../daml-integration-kit/index.html">Daml Integration Kit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tools/ledger-api-test-tool/index.html">Ledger API Test Tool</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/visual.html">Visualizing Daml Contracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/interoperability.html">Ledger Interoperability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/non-repudiation.html">Non-repudiation</a></li>
</ul>
<p class="caption"><span class="caption-text">Daml Ecosystem</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../support/overview.html">Daml Ecosystem Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../support/status-definitions.html">Status Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../support/component-statuses.html">Feature and Component Statuses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../support/releases.html">Releases and Versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support/compatibility.html">Portability, Compatibility, and Support Durations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support/support.html">Getting Help</a></li>
</ul>

          
          
          
          <div class="pdf-download"><a href="../../_downloads/DigitalAssetSDK.pdf" download>Download as PDF</a></div>
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <div class="topbar fixed">
        
        <nav class="wy-nav-top" aria-label="top navigation">
          
          <i data-toggle="wy-nav-top" class="wy-nav-top-toggle"></i>
          
        </nav>
        <!-- Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->

<div class="navbar">
    <h1><img src="../../_static/images/DAML_Logo_Blue.svg"></h1>
    <div class="navbar-menu">
        <div class="da-menu-item da-menu-depth-1" role="menu">
            <a href="https://www.daml.com/" role="menuitem" class="da-menu-link">Developers</a>
        </div>
        <div class="da-menu-item da-menu-depth-1" role="menu">
            <a href="https://www.digitalasset.com/products" role="menuitem" class="da-menu-link">Products</a>
        </div>
        <div class="da-menu-item da-menu-depth-1" role="menu">
            <a href="https://www.digitalasset.com" role="menuitem" class="da-menu-link">Company</a>
        </div>
    </div>
</div>

        <div class="version ">
          <span class="hide-mobile">Version&nbsp;</span><span class="version_switcher_placeholder"></span>
          
        </div>


        <!-- Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->
<div class="search-inline">
    <div id="rtd-search-inline-form" class="wy-form">
        <input type="text" class="search-inline-input" placeholder="Search" name="q">
        <img src="../../_static/images/Search.svg" class="search-inline-img"/>
    </div>
    <div class="search-alert">
        Please enter at least 3 letters.
    </div>
    <div id="search-inline-results" class="search-inline-results">
        
    </div>
</div>
          <!-- Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->

<div class="content-menu collapsed">
    <span class="content-menu-title">In This Section</span>
    <span class="content-menu-expand"></span>
    <div class="content-menu-wrapper">
        
        <!-- Local TOC -->
        <div class="content-menu-toc"><ul>
<li><a class="reference internal" href="#">2 Testing templates using Daml Script</a><ul>
<li><a class="reference internal" href="#script-basics">Script basics</a></li>
<li><a class="reference internal" href="#running-scripts">Running scripts</a></li>
<li><a class="reference internal" href="#testing-for-failure">Testing for failure</a></li>
<li><a class="reference internal" href="#archiving-contracts">Archiving contracts</a></li>
<li><a class="reference internal" href="#exploring-the-ledger">Exploring the ledger</a></li>
<li><a class="reference internal" href="#exercises">Exercises</a></li>
<li><a class="reference internal" href="#next-up">Next up</a></li>
</ul>
</li>
</ul>
</div>
        
    </div>
</div>
        

      </div>
      <div class="wy-nav-content">
        
        <div class="rst-content">
          
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div itemprop="articleBody">
                
  <div class="section" id="testing-templates-using-daml-script">
<span id="testing-using-script"></span><h1>2 Testing templates using Daml Script<a class="headerlink" href="#testing-templates-using-daml-script" title="Permalink to this headline">¶</a></h1>
<p>In this section you will test the <code class="docutils literal notranslate"><span class="pre">Token</span></code> model from <a class="reference internal" href="1_Token.html"><span class="doc">1 Basic contracts</span></a> using the <a class="reference internal" href="../../daml-script/index.html"><span class="doc">Daml Script</span></a> integration in <a class="reference internal" href="../daml-studio.html#scenario-script-results"><span class="std std-ref">Daml Studio</span></a>. You’ll learn about the basic features of :</p>
<ul class="simple">
<li>Allocating parties</li>
<li>Submitting transactions</li>
<li>Creating contracts</li>
<li>Testing for failure</li>
<li>Archiving contracts</li>
<li>Viewing ledger and final ledger state</li>
</ul>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Remember that you can load all the code for this section into a folder called <code class="docutils literal notranslate"><span class="pre">daml-intro-2</span></code> by running <code class="docutils literal notranslate"><span class="pre">daml</span> <span class="pre">new</span> <span class="pre">daml-intro-2</span> <span class="pre">--template</span> <span class="pre">daml-intro-2</span></code></p>
</div>
<div class="section" id="script-basics">
<h2>Script basics<a class="headerlink" href="#script-basics" title="Permalink to this headline">¶</a></h2>
<p>A <code class="docutils literal notranslate"><span class="pre">Script</span></code> is like a recipe for a test, where you can script different parties submitting a series of transactions, to check that your templates behave as you’d expect. You can also script some external information like party identities, and ledger time.</p>
<p>Below is a basic script that creates a <code class="docutils literal notranslate"><span class="pre">Token</span></code> for a party called “Alice”.</p>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span><span class="nf">token_test_1</span> <span class="ow">=</span> <span class="n">script</span> <span class="kr">do</span>
  <span class="n">alice</span> <span class="ow">&lt;-</span> <span class="n">allocateParty</span> <span class="s">&quot;Alice&quot;</span>
  <span class="n">submit</span> <span class="n">alice</span> <span class="kr">do</span>
    <span class="n">createCmd</span> <span class="kt">Token</span> <span class="kr">with</span> <span class="n">owner</span> <span class="ow">=</span> <span class="n">alice</span>
</pre></div>
</div>
<p>You declare a <code class="docutils literal notranslate"><span class="pre">Script</span></code> as a top-level variable and introduce it using <code class="docutils literal notranslate"><span class="pre">script</span> <span class="pre">do</span></code>. <code class="docutils literal notranslate"><span class="pre">do</span></code> always starts a block, so the rest of the script is indented.</p>
<p>Before you can create any <code class="docutils literal notranslate"><span class="pre">Token</span></code> contracts, you need some parties on the test ledger. The above script uses the function <code class="docutils literal notranslate"><span class="pre">allocateParty</span></code> to put a party called “Alice” in a variable <code class="docutils literal notranslate"><span class="pre">alice</span></code>. There are two things of note there:</p>
<ul>
<li><p class="first">Use of <code class="docutils literal notranslate"><span class="pre">&lt;-</span></code> instead of <code class="docutils literal notranslate"><span class="pre">=</span></code>.</p>
<p>The reason for that is <code class="docutils literal notranslate"><span class="pre">allocateParty</span></code> is an <code class="docutils literal notranslate"><span class="pre">Action</span></code> that can only be performed once the <code class="docutils literal notranslate"><span class="pre">Script</span></code> is run in the context of a ledger. <code class="docutils literal notranslate"><span class="pre">&lt;-</span></code> means “run the action and bind the result”. It can only be run in that context because, depending on the ledger state the script is running on, <code class="docutils literal notranslate"><span class="pre">allocateParty</span></code> will either give you back a party with the name you specified or append a suffix to that name if such a party has already been allocated.</p>
<p>More on <code class="docutils literal notranslate"><span class="pre">Actions</span></code> and <code class="docutils literal notranslate"><span class="pre">do</span></code> blocks in <a class="reference internal" href="5_Restrictions.html"><span class="doc">5 Adding constraints to a contract</span></a>.</p>
<p>If that doesn’t quite make sense yet, for the time being you can think of this arrow as extracting the right-hand-side value from the ledger and storing it into the variable on the left.</p>
</li>
<li><p class="first">The argument <code class="docutils literal notranslate"><span class="pre">&quot;Alice&quot;</span></code> to <code class="docutils literal notranslate"><span class="pre">allocateParty</span></code> does not have to be enclosed in brackets. Functions in Daml are called using the syntax <code class="docutils literal notranslate"><span class="pre">fn</span> <span class="pre">arg1</span> <span class="pre">arg2</span> <span class="pre">arg3</span></code>.</p>
</li>
</ul>
<p>With a variable <code class="docutils literal notranslate"><span class="pre">alice</span></code> of type <code class="docutils literal notranslate"><span class="pre">Party</span></code> in hand, you can submit your first transaction. Unsurprisingly, you do this using the <code class="docutils literal notranslate"><span class="pre">submit</span></code> function. <code class="docutils literal notranslate"><span class="pre">submit</span></code> takes two arguments: the <code class="docutils literal notranslate"><span class="pre">Party</span></code> and the <code class="docutils literal notranslate"><span class="pre">Commands</span></code>.</p>
<p>Just like <code class="docutils literal notranslate"><span class="pre">Script</span></code> is a recipe for a test, <code class="docutils literal notranslate"><span class="pre">Commands</span></code> is a recipe for a transaction. <code class="docutils literal notranslate"><span class="pre">createCmd</span> <span class="pre">Token</span> <span class="pre">with</span> <span class="pre">owner</span> <span class="pre">=</span> <span class="pre">alice</span></code> is a <code class="docutils literal notranslate"><span class="pre">Commands</span></code>, which translates to a list of commands that will be submitted to the ledger creating a transaction which creates a <code class="docutils literal notranslate"><span class="pre">Token</span></code> with owner Alice.</p>
<p>You’ll learn all about the syntax <code class="docutils literal notranslate"><span class="pre">Token</span> <span class="pre">with</span> <span class="pre">owner</span> <span class="pre">=</span> <span class="pre">alice</span></code> in <a class="reference internal" href="3_Data.html"><span class="doc">3 Data types</span></a>.</p>
<p>You could write this as <code class="docutils literal notranslate"><span class="pre">submit</span> <span class="pre">alice</span> <span class="pre">(createCmd</span> <span class="pre">Token</span> <span class="pre">with</span> <span class="pre">owner</span> <span class="pre">=</span> <span class="pre">alice)</span></code>, but just like scripts, you can assemble commands using <code class="docutils literal notranslate"><span class="pre">do</span></code> blocks. A <code class="docutils literal notranslate"><span class="pre">do</span></code> block always takes the value of the last statement within it so the syntax shown in the commands above gives the same result, whilst being easier to read. Note however, that the commands submitted as part of a transaction are not allowed to depend on each other.</p>
</div>
<div class="section" id="running-scripts">
<h2>Running scripts<a class="headerlink" href="#running-scripts" title="Permalink to this headline">¶</a></h2>
<p>There are a few ways to run Daml Scripts:</p>
<ul class="simple">
<li>In Daml Studio against a test ledger, providing visualizations of the resulting ledger.</li>
<li>Using the command line <code class="docutils literal notranslate"><span class="pre">daml</span> <span class="pre">test</span></code> also against a test ledger, useful for continuous integration.</li>
<li>Against a real ledger, take a look at the documentation for <a class="reference internal" href="../../daml-script/index.html"><span class="doc">Daml Script</span></a> for more information.</li>
<li>Interactively using <a class="reference internal" href="../../daml-repl/index.html"><span class="doc">Daml REPL</span></a>.</li>
</ul>
<p>In Daml Studio, you should see the text “Script results” just above the line <code class="docutils literal notranslate"><span class="pre">token_test_1</span> <span class="pre">=</span> <span class="pre">do</span></code>. Click on it to display the outcome of the script.</p>
<div class="figure">
<img alt="../../_images/scenario_results1.png" src="../../_images/scenario_results1.png" />
</div>
<p>This opens the script view in a separate column in VS Code. The default view is a tabular representation of the final state of the ledger:</p>
<div class="figure">
<img alt="../../_images/tabular_view1.png" src="../../_images/tabular_view1.png" />
</div>
<p>What this display means:</p>
<ul class="simple">
<li>The big title reading <code class="docutils literal notranslate"><span class="pre">Token_Test:Token</span></code> is the identifier of the type of contract that’s listed below. <code class="docutils literal notranslate"><span class="pre">Token_Test</span></code> is the module name, <code class="docutils literal notranslate"><span class="pre">Token</span></code> the template name.</li>
<li>The first columns, labelled vertically, show which parties know about which contracts. In this simple script, the sole party “Alice” knows about the contract she created.</li>
<li>The second column shows the ID of the contract. This will be explained later.</li>
<li>The third column shows the status of the contract, either <code class="docutils literal notranslate"><span class="pre">active</span></code> or <code class="docutils literal notranslate"><span class="pre">archived</span></code>.</li>
<li>The remaining columns show the contract arguments, with one column per field. As expected, field <code class="docutils literal notranslate"><span class="pre">owner</span></code> is <code class="docutils literal notranslate"><span class="pre">'Alice'</span></code>. The single quotation marks indicate that <code class="docutils literal notranslate"><span class="pre">Alice</span></code> is a party.</li>
</ul>
<p>To run the same test from the command line, save your module in a file <code class="docutils literal notranslate"><span class="pre">Token_Test.daml</span></code> and run <code class="docutils literal notranslate"><span class="pre">daml</span> <span class="pre">damlc</span> <span class="pre">--</span> <span class="pre">test</span> <span class="pre">--files</span> <span class="pre">Token_Test.daml</span></code>. If your file contains more than one script, all of them will be run.</p>
</div>
<div class="section" id="testing-for-failure">
<span id="intro-2-failure"></span><h2>Testing for failure<a class="headerlink" href="#testing-for-failure" title="Permalink to this headline">¶</a></h2>
<p>In <a class="reference internal" href="1_Token.html"><span class="doc">1 Basic contracts</span></a> you learned that creating a <code class="docutils literal notranslate"><span class="pre">Token</span></code> requires the authority of its owner. In other words, it should not be possible for Alice to create a Token for another party and vice versa. A reasonable attempt to test that would be:</p>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span><span class="nf">failing_test_1</span> <span class="ow">=</span> <span class="kr">do</span>
  <span class="n">alice</span> <span class="ow">&lt;-</span> <span class="n">allocateParty</span> <span class="s">&quot;Alice&quot;</span>
  <span class="n">bob</span> <span class="ow">&lt;-</span> <span class="n">allocateParty</span> <span class="s">&quot;Bob&quot;</span>
  <span class="n">submit</span> <span class="n">alice</span> <span class="kr">do</span>
    <span class="n">createCmd</span> <span class="kt">Token</span> <span class="kr">with</span> <span class="n">owner</span> <span class="ow">=</span> <span class="n">bob</span>
  <span class="n">submit</span> <span class="n">bob</span> <span class="kr">do</span>
    <span class="n">createCmd</span> <span class="kt">Token</span> <span class="kr">with</span> <span class="n">owner</span> <span class="ow">=</span> <span class="n">alice</span>
</pre></div>
</div>
<p>However, if you open the script view for that script, you see the following message:</p>
<div class="figure">
<img alt="../../_images/failure.png" src="../../_images/failure.png" />
</div>
<p>The script failed, as expected, but scripts abort at the first failure. This means that it only tested that Alice can’t create a token for Bob, and the second <code class="docutils literal notranslate"><span class="pre">submit</span></code> statement was never reached.</p>
<p>To test for failing submits and keep the script running thereafter, or fail if the submission succeeds, you can use the <code class="docutils literal notranslate"><span class="pre">submitMustFail</span></code> function:</p>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span><span class="nf">token_test_2</span> <span class="ow">=</span> <span class="kr">do</span>
  <span class="n">alice</span> <span class="ow">&lt;-</span> <span class="n">allocateParty</span> <span class="s">&quot;Alice&quot;</span>
  <span class="n">bob</span> <span class="ow">&lt;-</span> <span class="n">allocateParty</span> <span class="s">&quot;Bob&quot;</span>

  <span class="n">submitMustFail</span> <span class="n">alice</span> <span class="kr">do</span>
    <span class="n">createCmd</span> <span class="kt">Token</span> <span class="kr">with</span> <span class="n">owner</span> <span class="ow">=</span> <span class="n">bob</span>
  <span class="n">submitMustFail</span> <span class="n">bob</span> <span class="kr">do</span>
    <span class="n">createCmd</span> <span class="kt">Token</span> <span class="kr">with</span> <span class="n">owner</span> <span class="ow">=</span> <span class="n">alice</span>

  <span class="n">submit</span> <span class="n">alice</span> <span class="kr">do</span>
    <span class="n">createCmd</span> <span class="kt">Token</span> <span class="kr">with</span> <span class="n">owner</span> <span class="ow">=</span> <span class="n">alice</span>
  <span class="n">submit</span> <span class="n">bob</span> <span class="kr">do</span>
    <span class="n">createCmd</span> <span class="kt">Token</span> <span class="kr">with</span> <span class="n">owner</span> <span class="ow">=</span> <span class="n">bob</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">submitMustFail</span></code> never has an impact on the ledger so the resulting tabular script view just shows the two Tokens resulting from the successful <code class="docutils literal notranslate"><span class="pre">submit</span></code> statements. Note the new column for Bob as well as the visibilities. Alice and Bob cannot see each others’ Tokens.</p>
</div>
<div class="section" id="archiving-contracts">
<span id="archiving"></span><h2>Archiving contracts<a class="headerlink" href="#archiving-contracts" title="Permalink to this headline">¶</a></h2>
<p>Archiving contracts works just like creating them, but using <code class="docutils literal notranslate"><span class="pre">archiveCmd</span></code> instead of <code class="docutils literal notranslate"><span class="pre">createCmd</span></code>. Where <code class="docutils literal notranslate"><span class="pre">createCmd</span></code> takes an instance of a template, <code class="docutils literal notranslate"><span class="pre">archiveCmd</span></code> takes a reference to a contract.</p>
<p>References to contracts have the type <code class="docutils literal notranslate"><span class="pre">ContractId</span> <span class="pre">a</span></code>, where <code class="docutils literal notranslate"><span class="pre">a</span></code> is a <em>type parameter</em> representing the type of contract that the ID refers to. For example, a reference to a <code class="docutils literal notranslate"><span class="pre">Token</span></code> would be a <code class="docutils literal notranslate"><span class="pre">ContractId</span> <span class="pre">Token</span></code>.</p>
<p>To <code class="docutils literal notranslate"><span class="pre">archiveCmd</span></code> the Token Alice has created, you need to get a handle on its contract ID. In scripts, you do this using <code class="docutils literal notranslate"><span class="pre">&lt;-</span></code> notation. That’s because the contract ID needs to be retrieved from the ledger. How this works is discussed in <a class="reference internal" href="5_Restrictions.html"><span class="doc">5 Adding constraints to a contract</span></a>.</p>
<p>This script first checks that Bob cannot archive Alice’s Token and then Alice successfully archives it:</p>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span><span class="nf">token_test_3</span> <span class="ow">=</span> <span class="kr">do</span>
  <span class="n">alice</span> <span class="ow">&lt;-</span> <span class="n">allocateParty</span> <span class="s">&quot;Alice&quot;</span>
  <span class="n">bob</span> <span class="ow">&lt;-</span> <span class="n">allocateParty</span> <span class="s">&quot;Bob&quot;</span>

  <span class="n">alice_token</span> <span class="ow">&lt;-</span> <span class="n">submit</span> <span class="n">alice</span> <span class="kr">do</span>
    <span class="n">createCmd</span> <span class="kt">Token</span> <span class="kr">with</span> <span class="n">owner</span> <span class="ow">=</span> <span class="n">alice</span>

  <span class="n">submitMustFail</span> <span class="n">bob</span> <span class="kr">do</span>
    <span class="n">archiveCmd</span> <span class="n">alice_token</span>

  <span class="n">submit</span> <span class="n">alice</span> <span class="kr">do</span>
    <span class="n">archiveCmd</span> <span class="n">alice_token</span>
</pre></div>
</div>
</div>
<div class="section" id="exploring-the-ledger">
<h2>Exploring the ledger<a class="headerlink" href="#exploring-the-ledger" title="Permalink to this headline">¶</a></h2>
<p>The resulting script view is empty, because there are no contracts left on the ledger. However, if you want to see the history of the ledger, e.g. to see how you got to that state, tick the “Show archived” box at the top of the ledger view:</p>
<div class="figure">
<img alt="../../_images/archived.png" src="../../_images/archived.png" />
</div>
<p>You can see that there was a <code class="docutils literal notranslate"><span class="pre">Token</span></code> contract, which is now archived, indicated both by the “archived” value in the <code class="docutils literal notranslate"><span class="pre">status</span></code> column as well as by a strikethrough.</p>
<p>Click on the adjacent “Show transaction view” button to see the entire transaction graph:</p>
<div class="figure">
<img alt="../../_images/tx_graph.png" src="../../_images/tx_graph.png" />
</div>
<p>In the Daml Studio script runner, committed transactions are numbered sequentially. The lines starting with <code class="docutils literal notranslate"><span class="pre">TX</span></code> indicate that there are three committed transactions, with ids <code class="docutils literal notranslate"><span class="pre">#0</span></code>, <code class="docutils literal notranslate"><span class="pre">#1</span></code>, and <code class="docutils literal notranslate"><span class="pre">#2</span></code>. These correspond to the three <code class="docutils literal notranslate"><span class="pre">submit</span></code> and <code class="docutils literal notranslate"><span class="pre">submitMustFail</span></code> statements in the script.</p>
<p>Transaction <code class="docutils literal notranslate"><span class="pre">#0</span></code> has one <em>sub-transaction</em> <code class="docutils literal notranslate"><span class="pre">#0:0</span></code>, which the arrow indicates is a <code class="docutils literal notranslate"><span class="pre">create</span></code> of a <code class="docutils literal notranslate"><span class="pre">Token</span></code>. Identifiers <code class="docutils literal notranslate"><span class="pre">#X:Y</span></code> mean <code class="docutils literal notranslate"><span class="pre">commit</span> <span class="pre">X,</span> <span class="pre">sub-transaction</span> <span class="pre">Y</span></code>. All transactions have this format in the script runner. However, this format is a testing feature. In general, you should consider Transaction and Contract IDs to be opaque.</p>
<p>The lines above and below <code class="docutils literal notranslate"><span class="pre">create</span> <span class="pre">Token_Test:Token</span></code> give additional information:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">consumed</span> <span class="pre">by:</span> <span class="pre">#2:0</span></code> tells you that the contract is archived in sub-transaction <code class="docutils literal notranslate"><span class="pre">0</span></code> of commit <code class="docutils literal notranslate"><span class="pre">2</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">referenced</span> <span class="pre">by</span> <span class="pre">#2:0</span></code> tells you that the contract was used in other transactions, and lists their IDs.</li>
<li><code class="docutils literal notranslate"><span class="pre">known</span> <span class="pre">to</span> <span class="pre">(since):</span> <span class="pre">'Alice'</span> <span class="pre">(#0)</span></code> tells you who knows about the contract. The fact that <code class="docutils literal notranslate"><span class="pre">'Alice'</span></code> appears in the list is equivalent to a <code class="docutils literal notranslate"><span class="pre">x</span></code> in the tabular view. The <code class="docutils literal notranslate"><span class="pre">(#0)</span></code> gives you the additional information that <code class="docutils literal notranslate"><span class="pre">Alice</span></code> learned about the contract in commit <code class="docutils literal notranslate"><span class="pre">#0</span></code>.</li>
<li>Everything following <code class="docutils literal notranslate"><span class="pre">with</span></code> shows the create arguments.</li>
</ul>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<p>To get a better understanding of script, try the following exercises:</p>
<ol class="arabic simple">
<li>Write a template for a second type of Token.</li>
<li>Write a script with two parties and two types of tokens, creating one token of each type for each party and archiving one token for each party, leaving one token of each type in the final ledger view.</li>
<li>In <a class="reference internal" href="#archiving"><span class="std std-ref">Archiving contracts</span></a> you tested that Bob cannot archive Alice’s token. Can you guess why the submit fails? How can you find out why the submit fails?</li>
</ol>
<blockquote>
<div><div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Remember that in <a class="reference internal" href="#intro-2-failure"><span class="std std-ref">Testing for failure</span></a> we saw a proper error message for a failing submit.</p>
</div>
</div></blockquote>
</div>
<div class="section" id="next-up">
<h2>Next up<a class="headerlink" href="#next-up" title="Permalink to this headline">¶</a></h2>
<p>In <a class="reference internal" href="3_Data.html"><span class="doc">3 Data types</span></a> you will learn about Daml’s type system, and how you can think of templates as tables and contracts as database rows.</p>
</div>
</div>


              
            </div>
            
            
              <!-- Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->

<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="1_Token.html" class="da-btn da-btn-label btn-prev" title="1 Basic contracts" accesskey="p" rel="prev">Previous</a>
      
      
        <a href="3_Data.html" class="da-btn da-btn-label btn-next" title="3 Data types" accesskey="n" rel="next">Next</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. Any unauthorized use, duplication or distribution is strictly prohibited. &#34;Digital Asset&#34; and &#34;Daml&#34; are Registered in the U.S. Patent and Trademark Office.

    </p>
  </div> 

</footer>
            
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->





  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.Navigation.enable(true);
      });
  </script>


  
    
  
  <div id="inpageContent"></div>
  

</body>
</html>