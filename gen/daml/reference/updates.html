<!-- Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Reference: updates &mdash; Daml SDK __VERSION__ documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
  
  <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  <script type="text/javascript" src="../../_static/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/copybutton.js"></script>
  
  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="next" title="Reference: data types" href="data-types.html" />
  <link rel="prev" title="Reference: choices" href="choices.html" /> 

  
  <link rel="icon" type="image/svg+xml"  href="../../_static/images/daml-logo-mark-light.svg">
  <link rel="alternate icon" href="../../_static/images/daml-favicon-1.ico">

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-MSWJMNX');</script>
  <!-- End Google Tag Manager -->

  
  <!-- Mopinion Pastea.se  start --><script type="text/javascript">(function(){var id="4s6vwov7ad6qyxhq8iwbyhocrsn2nm36k25";var js=document.createElement("script");js.setAttribute("type","text/javascript");js.setAttribute("src","//deploy.mopinion.com/js/pastease.js");js.async=true;document.getElementsByTagName("head")[0].appendChild(js);var t=setInterval(function(){try{new Pastease.load(id);clearInterval(t)}catch(e){}},50)})();</script><!-- Mopinion Pastea.se end -->
</head>

<body class="wy-body-for-nav">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MSWJMNX"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-nav-side-shadow"></div>
      <div class="wy-side-scroll">

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
          
          
          
          
          
          <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Daml Documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/installation.html">Installing the SDK</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/path-variables.html">Setting JAVA_HOME and PATH variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/manual-download.html">Manually installing the SDK</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.html">Building Your App</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/app-architecture.html">App Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/first-feature.html">Your First Feature</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.daml.com/cheat-sheet">Cheat Sheet</a></li>
</ul>
<p class="caption"><span class="caption-text">Writing Daml</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/0_Intro.html">An introduction to Daml</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro/1_Token.html">1 Basic contracts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/2_DamlScript.html">2 Testing templates using Daml Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/3_Data.html">3 Data types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/4_Transformations.html">4 Transforming data using choices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/5_Restrictions.html">5 Adding constraints to a contract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/6_Parties.html">6 Parties and authority</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/7_Composing.html">7 Composing choices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/8_Exceptions.html">8 Exception Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/9_Dependencies.html">9 Working with Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/10_Functional101.html">10 Functional Programming 101</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/11_StdLib.html">11 Intro to the Daml Standard Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/12_Testing.html">12 Testing Daml Contracts</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Language reference docs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="structure.html">Overview: template structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="templates.html">Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="choices.html">Choices</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Updates</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-types.html">Data types</a></li>
<li class="toctree-l2"><a class="reference internal" href="working-with.html">Built-in functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="expressions.html">Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="scenarios.html">Scenarios</a></li>
<li class="toctree-l2"><a class="reference internal" href="file-structure.html">File structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="packages.html">Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="contract-keys.html">Contract keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="exceptions.html">Exceptions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../patterns.html">Good design patterns</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../patterns/initaccept.html">Initiate and Accept</a></li>
<li class="toctree-l2"><a class="reference internal" href="../patterns/multiparty-agreement.html">Multiple party agreement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../patterns/delegation.html">Delegation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../patterns/authorization.html">Authorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../patterns/locking.html">Locking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../patterns/locking/locking-by-archiving.html">Locking by archiving</a></li>
<li class="toctree-l3"><a class="reference internal" href="../patterns/locking/locking-by-state.html">Locking by state</a></li>
<li class="toctree-l3"><a class="reference internal" href="../patterns/locking/locking-by-safekeeping.html">Locking by safekeeping</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../patterns/legends.html">Diagram legends</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Building applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../app-dev/app-arch.html">Application architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../app-dev/bindings-ts/index.html">JavaScript Client Libraries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-ts/daml2js.html">JavaScript Code Generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-ts/daml-react.html">&#64;daml/react</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-ts/daml-ledger.html">&#64;daml/ledger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-ts/daml-types.html">&#64;daml/types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-ts/testing.html">Testing Your Web App</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../json-api/index.html">HTTP JSON API Service</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../json-api/lf-value-specification.html">Daml-LF JSON Encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../json-api/search-query-language.html">Query language</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../json-api/production-setup.html">Production Setup</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../daml-script/index.html">Daml Script</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../daml-repl/index.html">Daml REPL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../upgrade/index.html">Upgrading and Extending Daml applications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../upgrade/extend.html">Extending Daml applications</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../upgrade/upgrade.html">Upgrading Daml applications</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../upgrade/automation.html">Automating the Upgrade Process</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../app-dev/authorization.html">Authorization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../app-dev/ledger-api.html">The Ledger API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/services.html">The Ledger API services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/grpc/index.html">gRPC</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/grpc/error-codes.html">Error Codes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/grpc/daml-to-ledger-api.html">How Daml types are translated to protobuf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/daml-lf-translation.html">How Daml types are translated to Daml-LF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-java/index.html">Java bindings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/bindings-java/codegen.html">Generate Java code from Daml</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/bindings-java/example.html">Ping Pong Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../app-dev/bindings-java/quickstart.html">Iou Quickstart Tutorial</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-scala/index.html">Scala bindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-js.html">Node.js bindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app-dev/bindings-x-lang/index.html">Creating your own bindings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../triggers/index.html">Daml Triggers - Off-Ledger Automation in Daml</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/trigger-service/index.html">Trigger Service</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tools/trigger-service/authorization.html">Authorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tools/trigger-service/auth0_example.html">Auth0 Example Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/auth-middleware/index.html">Auth Middleware</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tools/auth-middleware/oauth2.html">OAuth 2.0 Auth Middleware</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Deploying to Daml ledgers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../deploy/index.html">Overview of Daml ledgers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deploy/generic_ledger.html">Deploying to a generic Daml ledger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deploy/ledger-topologies.html">Daml Ledger Topologies</a></li>
</ul>
<p class="caption"><span class="caption-text">Operating Daml</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ops/index.html">Daml Participant pruning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ops/connect/index.html">Operating Daml Connect</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ops/connect/helm.html">Connect Helm Chart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ops/connect/auth0.html">Setting Up Auth0</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Developer Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tools/assistant.html">Daml Assistant (<code class="docutils literal notranslate"><span class="pre">daml</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../daml-studio.html">Daml Studio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/sandbox.html">Daml Sandbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/navigator/index.html">Navigator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/codegen.html">Daml codegen</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/profiler.html">Daml Profiler</a></li>
</ul>
<p class="caption"><span class="caption-text">Background concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/glossary.html">Glossary of concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/ledger-model/index.html">Daml Ledger Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ledger-model/ledger-structure.html">Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ledger-model/ledger-integrity.html">Integrity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ledger-model/ledger-privacy.html">Privacy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ledger-model/ledger-daml.html">Daml: Defining Contract Models Compactly</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/ledger-model/ledger-exceptions.html">Exceptions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/identity-and-package-management.html">Identity and Package Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/time.html">Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/local-ledger.html">Causality and Local Ledgers</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://daml.com/examples">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Early Access Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tools/extractor.html">Extractor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/export/index.html">Ledger Export</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../daml-integration-kit/index.html">Daml Integration Kit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tools/ledger-api-test-tool/index.html">Ledger API Test Tool</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/visual.html">Visualizing Daml Contracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts/interoperability.html">Ledger Interoperability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/non-repudiation.html">Non-repudiation</a></li>
</ul>
<p class="caption"><span class="caption-text">Daml Ecosystem</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../support/overview.html">Daml Ecosystem Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../support/status-definitions.html">Status Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../support/component-statuses.html">Feature and Component Statuses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../support/releases.html">Releases and Versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support/compatibility.html">Portability, Compatibility, and Support Durations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support/support.html">Getting Help</a></li>
</ul>

          
          
          
          <div class="pdf-download"><a href="../../_downloads/DigitalAssetSDK.pdf" download>Download as PDF</a></div>
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <div class="topbar fixed">
        
        <nav class="wy-nav-top" aria-label="top navigation">
          
          <i data-toggle="wy-nav-top" class="wy-nav-top-toggle"></i>
          
        </nav>
        <!-- Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->

<div class="navbar">
    <h1><img src="../../_static/images/DAML_Logo_Blue.svg"></h1>
    <div class="navbar-menu">
        <div class="da-menu-item da-menu-depth-1" role="menu">
            <a href="https://www.daml.com/" role="menuitem" class="da-menu-link">Developers</a>
        </div>
        <div class="da-menu-item da-menu-depth-1" role="menu">
            <a href="https://www.digitalasset.com/products" role="menuitem" class="da-menu-link">Products</a>
        </div>
        <div class="da-menu-item da-menu-depth-1" role="menu">
            <a href="https://www.digitalasset.com" role="menuitem" class="da-menu-link">Company</a>
        </div>
    </div>
</div>

        <div class="version ">
          <span class="hide-mobile">Version&nbsp;</span><span class="version_switcher_placeholder"></span>
          
        </div>


        <!-- Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->
<div class="search-inline">
    <div id="rtd-search-inline-form" class="wy-form">
        <input type="text" class="search-inline-input" placeholder="Search" name="q">
        <img src="../../_static/images/Search.svg" class="search-inline-img"/>
    </div>
    <div class="search-alert">
        Please enter at least 3 letters.
    </div>
    <div id="search-inline-results" class="search-inline-results">
        
    </div>
</div>
          <!-- Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->

<div class="content-menu collapsed">
    <span class="content-menu-title">In This Section</span>
    <span class="content-menu-expand"></span>
    <div class="content-menu-wrapper">
        
        <!-- Local TOC -->
        <div class="content-menu-toc"><ul>
<li><a class="reference internal" href="#">Reference: updates</a><ul>
<li><a class="reference internal" href="#background">Background</a></li>
<li><a class="reference internal" href="#binding-variables">Binding variables</a></li>
<li><a class="reference internal" href="#do">do</a></li>
<li><a class="reference internal" href="#create">create</a></li>
<li><a class="reference internal" href="#exercise">exercise</a></li>
<li><a class="reference internal" href="#exercisebykey">exerciseByKey</a></li>
<li><a class="reference internal" href="#fetch">fetch</a></li>
<li><a class="reference internal" href="#fetchbykey">fetchByKey</a></li>
<li><a class="reference internal" href="#lookupbykey">lookupByKey</a></li>
<li><a class="reference internal" href="#abort">abort</a></li>
<li><a class="reference internal" href="#assert">assert</a></li>
<li><a class="reference internal" href="#gettime">getTime</a></li>
<li><a class="reference internal" href="#return">return</a></li>
<li><a class="reference internal" href="#let">let</a></li>
<li><a class="reference internal" href="#this">this</a></li>
</ul>
</li>
</ul>
</div>
        
    </div>
</div>
        

      </div>
      <div class="wy-nav-content">
        
        <div class="rst-content">
          
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div itemprop="articleBody">
                
  <div class="section" id="reference-updates">
<h1>Reference: updates<a class="headerlink" href="#reference-updates" title="Permalink to this headline">¶</a></h1>
<p>This page gives reference information on Updates. For the structure around them, see <a class="reference internal" href="structure.html"><span class="doc">Overview: template structure</span></a>.</p>
<div class="section" id="background">
<span id="daml-ref-updates-background"></span><h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>An <code class="docutils literal notranslate"><span class="pre">Update</span></code> is ledger update. There are many different kinds of these, and they’re listed below.</li>
<li>They are what can go in a <a class="reference internal" href="choices.html#daml-ref-choice-body"><span class="std std-ref">choice body</span></a>.</li>
</ul>
</div>
<div class="section" id="binding-variables">
<span id="daml-ref-binding-variables"></span><h2>Binding variables<a class="headerlink" href="#binding-variables" title="Permalink to this headline">¶</a></h2>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span><span class="nf">boundVariable</span> <span class="ow">&lt;-</span> <span class="kt">UpdateExpression1</span>
</pre></div>
</div>
<ul class="simple">
<li>One of the things you can do in a choice body is bind (assign) an Update expression to a variable. This works for any of the Updates below.</li>
</ul>
</div>
<div class="section" id="do">
<span id="daml-ref-do"></span><h2>do<a class="headerlink" href="#do" title="Permalink to this headline">¶</a></h2>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span><span class="kr">do</span>
   <span class="n">updateExpression1</span>
   <span class="n">updateExpression2</span>
</pre></div>
</div>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">do</span></code> can be used to group <code class="docutils literal notranslate"><span class="pre">Update</span></code> expressions. You can only have one update expression in a choice, so any choice beyond the very simple will use a <code class="docutils literal notranslate"><span class="pre">do</span></code> block.</p>
</li>
<li><p class="first">Anything you can put into a choice body, you can put into a <code class="docutils literal notranslate"><span class="pre">do</span></code> block.</p>
</li>
<li><p class="first">By default, <code class="docutils literal notranslate"><span class="pre">do</span></code> returns whatever is returned by the <strong>last expression in the block</strong>.</p>
<p>So if you want to return something else, you’ll need to use <code class="docutils literal notranslate"><span class="pre">return</span></code> explicitly - see <a class="reference internal" href="#daml-ref-return"><span class="std std-ref">return</span></a> for an example.</p>
</li>
</ul>
</div>
<div class="section" id="create">
<span id="daml-ref-create"></span><h2>create<a class="headerlink" href="#create" title="Permalink to this headline">¶</a></h2>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span><span class="nf">create</span> <span class="kt">NameOfTemplate</span> <span class="kr">with</span> <span class="n">exampleParameters</span>
</pre></div>
</div>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">create</span></code> function.</p>
</li>
<li><p class="first">Creates a contract on the ledger. When a contract is committed to the ledger, it is given a unique contract identifier of type <code class="docutils literal notranslate"><span class="pre">ContractId</span> <span class="pre">&lt;name</span> <span class="pre">of</span> <span class="pre">template&gt;</span></code>.</p>
<p>Creating the contract returns that <code class="docutils literal notranslate"><span class="pre">ContractId</span></code>.</p>
</li>
<li><p class="first">Use <code class="docutils literal notranslate"><span class="pre">with</span></code> to specify the template parameters.</p>
</li>
<li><p class="first">Requires authorization from the signatories of the contract being created. This is given by being signatories of the contract from which the other contract is created, being the controller, or explicitly creating the contract itself.</p>
<p>If the required authorization is not given, the transaction fails. For more detail on authorization, see <a class="reference internal" href="templates.html#daml-ref-signatories"><span class="std std-ref">Signatory parties</span></a>.</p>
</li>
</ul>
</div>
<div class="section" id="exercise">
<span id="daml-ref-exercise"></span><h2>exercise<a class="headerlink" href="#exercise" title="Permalink to this headline">¶</a></h2>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span><span class="nf">exercise</span> <span class="kt">IdOfContract</span> <span class="kt">NameOfChoiceOnContract</span> <span class="kr">with</span> <span class="n">choiceArgument1</span> <span class="ow">=</span> <span class="n">value1</span>
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">exercise</span></code> function.</li>
<li>Exercises the specified choice on the specified contract.</li>
<li>Use <code class="docutils literal notranslate"><span class="pre">with</span></code> to specify the choice parameters.</li>
<li>Requires authorization from the controller(s) of the choice. If the authorization is not given, the transaction fails.</li>
</ul>
</div>
<div class="section" id="exercisebykey">
<span id="daml-ref-exercise-by-key"></span><h2>exerciseByKey<a class="headerlink" href="#exercisebykey" title="Permalink to this headline">¶</a></h2>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span><span class="nf">exerciseByKey</span> <span class="o">@</span><span class="kt">ContractType</span> <span class="n">contractKey</span> <span class="kt">NameOfChoiceOnContract</span> <span class="kr">with</span> <span class="n">choiceArgument1</span> <span class="ow">=</span> <span class="n">value1</span>
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">exerciseByKey</span></code> function.</li>
<li>Exercises the specified choice on the specified contract.</li>
<li>Use <code class="docutils literal notranslate"><span class="pre">with</span></code> to specify the choice parameters.</li>
<li>Requires authorization from the controller(s) of the choice <strong>and</strong> from at least one of the maintainers of the key. If the authorization is not given, the transaction fails.</li>
</ul>
</div>
<div class="section" id="fetch">
<span id="daml-ref-fetch"></span><h2>fetch<a class="headerlink" href="#fetch" title="Permalink to this headline">¶</a></h2>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span><span class="nf">fetchedContract</span> <span class="ow">&lt;-</span> <span class="n">fetch</span> <span class="kt">IdOfContract</span>
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">fetch</span></code> function.</li>
<li>Fetches the contract with that ID. Usually used with a bound variable, as in the example above.</li>
<li>Often used to check the details of a contract before exercising a choice on that contract. Also used when referring to some reference data.</li>
<li><code class="docutils literal notranslate"><span class="pre">fetch</span> <span class="pre">cid</span></code> fails if <code class="docutils literal notranslate"><span class="pre">cid</span></code> is not the contract id of an active contract, and thus causes the entire transaction to abort.</li>
<li>The submitting party must be an observer or signatory on the contract, otherwise <code class="docutils literal notranslate"><span class="pre">fetch</span></code> fails, and similarly causes the entire transaction to abort.</li>
</ul>
</div>
<div class="section" id="fetchbykey">
<span id="daml-ref-fetch-by-key"></span><h2>fetchByKey<a class="headerlink" href="#fetchbykey" title="Permalink to this headline">¶</a></h2>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span><span class="nf">fetchedContract</span> <span class="ow">&lt;-</span> <span class="n">fetchByKey</span> <span class="o">@</span><span class="kt">ContractType</span> <span class="n">contractKey</span>
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">fetchByKey</span></code> function.</li>
<li>The same as <code class="docutils literal notranslate"><span class="pre">fetch</span></code>, but fetches the contract with that <a class="reference internal" href="contract-keys.html"><span class="doc">contract key</span></a>, instead of the contract ID.</li>
<li>Like <code class="docutils literal notranslate"><span class="pre">fetch</span></code>, <code class="docutils literal notranslate"><span class="pre">fetchByKey</span></code> needs to be authorized by at least one stakeholder of the contract.</li>
<li>Fails if no contract can be found.</li>
</ul>
</div>
<div class="section" id="lookupbykey">
<span id="daml-ref-lookup-by-key"></span><h2>lookupByKey<a class="headerlink" href="#lookupbykey" title="Permalink to this headline">¶</a></h2>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span><span class="nf">fetchedContractId</span> <span class="ow">&lt;-</span> <span class="n">lookupByKey</span> <span class="o">@</span><span class="kt">ContractType</span> <span class="n">contractKey</span>
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">lookupByKey</span></code> function.</li>
<li>Use this to confirm that a contract with the given <a class="reference internal" href="contract-keys.html"><span class="doc">contract key</span></a> exists.</li>
<li>If the submitting party is a stakeholder of a matching contract, <code class="docutils literal notranslate"><span class="pre">lookupByKey</span></code> returns the <code class="docutils literal notranslate"><span class="pre">ContractId</span></code> of the contract; otherwise, it returns <code class="docutils literal notranslate"><span class="pre">None</span></code>. Transactions may fail due to contention because the key changes between the lookup and committing the transaction, or becasue the submitter didn’t know about the existence of a matching contract.</li>
<li><strong>All</strong> of the maintainers of the key must authorize the lookup (by either being signatories or by submitting the command to lookup).</li>
</ul>
</div>
<div class="section" id="abort">
<span id="daml-ref-abort"></span><h2>abort<a class="headerlink" href="#abort" title="Permalink to this headline">¶</a></h2>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span><span class="nf">abort</span> <span class="n">errorMessage</span>
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">abort</span></code> function.</li>
<li>Fails the transaction - nothing in it will be committed to the ledger.</li>
<li><code class="docutils literal notranslate"><span class="pre">errorMessage</span></code> is of type <code class="docutils literal notranslate"><span class="pre">Text</span></code>. Use the error message to provide more context to an external system (e.g., it gets displayed in Daml Studio scenario results).</li>
<li>You could use <code class="docutils literal notranslate"><span class="pre">assert</span> <span class="pre">False</span></code> as an alternative.</li>
</ul>
</div>
<div class="section" id="assert">
<span id="daml-ref-assert"></span><h2>assert<a class="headerlink" href="#assert" title="Permalink to this headline">¶</a></h2>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span><span class="nf">assert</span> <span class="p">(</span><span class="n">condition</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">assert</span></code> keyword.</li>
<li>Fails the transaction if the condition is false. So the choice can only be exercised if the boolean expression evaluates to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</li>
<li>Often used to restrict the arguments that can be supplied to a contract choice.</li>
</ul>
<p>Here’s an example of using <code class="docutils literal notranslate"><span class="pre">assert</span></code> to prevent a choice being exercised if the <code class="docutils literal notranslate"><span class="pre">Party</span></code> passed as a parameter is on a blacklist:</p>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span>      <span class="kt">Transfer</span> <span class="kt">:</span> <span class="kt">ContractId</span> <span class="kt">RestrictedPayout</span>
        <span class="kr">with</span> <span class="n">newReceiver</span> <span class="kt">:</span> <span class="kt">Party</span>
        <span class="kr">do</span>
          <span class="n">assert</span> <span class="p">(</span><span class="n">newReceiver</span> <span class="o">/=</span> <span class="n">blacklisted</span><span class="p">)</span>
          <span class="n">create</span> <span class="kt">RestrictedPayout</span> <span class="kr">with</span> <span class="n">receiver</span> <span class="ow">=</span> <span class="n">newReceiver</span><span class="p">;</span> <span class="n">giver</span><span class="p">;</span> <span class="n">blacklisted</span><span class="p">;</span> <span class="n">qty</span>
</pre></div>
</div>
</div>
<div class="section" id="gettime">
<span id="daml-ref-gettime"></span><h2>getTime<a class="headerlink" href="#gettime" title="Permalink to this headline">¶</a></h2>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span><span class="nf">currentTime</span> <span class="ow">&lt;-</span> <span class="n">getTime</span>
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">getTime</span></code> keyword.</li>
<li>Gets the ledger time. (You will usually want to immediately bind it to a variable in order to be able to access the value.)</li>
<li>Used to restrict when a choice can be made. For example, with an <code class="docutils literal notranslate"><span class="pre">assert</span></code> that the time is later than a certain time.</li>
</ul>
<p>Here’s an example of a choice that uses a check on the current time:</p>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span>      <span class="kt">Complete</span> <span class="kt">:</span> <span class="nb">()</span>

        <span class="kr">do</span>
          <span class="c1">-- bind the ledger effective time to the tchoose variable using getTime</span>
          <span class="n">tchoose</span> <span class="ow">&lt;-</span> <span class="n">getTime</span>
</pre></div>
</div>
</div>
<div class="section" id="return">
<span id="daml-ref-return"></span><h2>return<a class="headerlink" href="#return" title="Permalink to this headline">¶</a></h2>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span><span class="kr">return</span> <span class="nb">()</span>
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">return</span></code> keyword.</li>
<li>Used to return a value from <code class="docutils literal notranslate"><span class="pre">do</span></code> block that is not of type <code class="docutils literal notranslate"><span class="pre">Update</span></code>.</li>
</ul>
<p>Here’s an example where two contracts are created in a choice and both their ids are returned as a tuple:</p>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span><span class="kr">do</span>
  <span class="n">firstContract</span> <span class="ow">&lt;-</span> <span class="n">create</span> <span class="kt">SomeContractTemplate</span> <span class="kr">with</span> <span class="n">arg1</span><span class="p">;</span> <span class="n">arg2</span>
  <span class="n">secondContract</span> <span class="ow">&lt;-</span> <span class="n">create</span> <span class="kt">SomeContractTemplate</span> <span class="kr">with</span> <span class="n">arg1</span><span class="p">;</span> <span class="n">arg2</span>
  <span class="kr">return</span> <span class="p">(</span><span class="n">firstContract</span><span class="p">,</span> <span class="n">secondContract</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="let">
<span id="daml-ref-let-update"></span><h2>let<a class="headerlink" href="#let" title="Permalink to this headline">¶</a></h2>
<p>See the documentation on <a class="reference internal" href="expressions.html#daml-ref-let"><span class="std std-ref">Let</span></a>.</p>
<p>Let looks similar to binding variables, but it’s very different! This code example shows how:</p>
<div class="highlight-daml notranslate"><div class="highlight"><pre><span></span><span class="kr">do</span>
  <span class="c1">-- defines a function, createdContract, taking a single argument that when</span>
  <span class="c1">-- called _will_ create the new contract using argument for issuer and owner</span>
  <span class="kr">let</span> <span class="n">createContract</span> <span class="n">x</span> <span class="ow">=</span> <span class="n">create</span> <span class="kt">NameOfContract</span> <span class="kr">with</span> <span class="n">issuer</span> <span class="ow">=</span> <span class="n">x</span><span class="p">;</span> <span class="n">owner</span> <span class="ow">=</span> <span class="n">x</span>

  <span class="n">createContract</span> <span class="n">party1</span>
  <span class="n">createContract</span> <span class="n">party2</span>
</pre></div>
</div>
</div>
<div class="section" id="this">
<span id="daml-ref-this"></span><h2>this<a class="headerlink" href="#this" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">this</span></code> lets you refer to the current contract from within the choice body. This refers to the contract, <em>not</em> the contract ID.</p>
<p>It’s useful, for example, if you want to pass the current contract to a helper function outside the template.</p>
</div>
</div>


              
            </div>
            
            
              <!-- Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->

<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="choices.html" class="da-btn da-btn-label btn-prev" title="Reference: choices" accesskey="p" rel="prev">Previous</a>
      
      
        <a href="data-types.html" class="da-btn da-btn-label btn-next" title="Reference: data types" accesskey="n" rel="next">Next</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. Any unauthorized use, duplication or distribution is strictly prohibited. &#34;Digital Asset&#34; and &#34;Daml&#34; are Registered in the U.S. Patent and Trademark Office.

    </p>
  </div> 

</footer>
            
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- Copyright (c) 2021 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->





  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.Navigation.enable(true);
      });
  </script>


  
    
  
  <div id="inpageContent"></div>
  

</body>
</html>